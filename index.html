<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>GPS 3D íŠ¸ë˜ì»¤ + ì§€ì˜¤íœìŠ¤</title>
<link href="https://unpkg.com/maplibre-gl@3.6.2/dist/maplibre-gl.css" rel="stylesheet"/>
<style>
  :root{
    --fx-color:#FF9800; /* ê¸°ë³¸ ì˜¤ë Œì§€(ì§„ì…) */
    --fx-ringW:10px;
    --fx-duration:1100ms;
  }
  *{box-sizing:border-box}
  body{margin:0;font-family:system-ui,Segoe UI,Apple SD Gothic Neo,Apple Color Emoji,sans-serif;background:#0b1020;color:#111}
  .topbar{
    position:fixed;left:0;right:0;top:0;z-index:10;
    background:rgba(255,255,255,.92);backdrop-filter:saturate(1.2) blur(8px);
    padding:10px 12px;border-bottom:1px solid #e6e6e6;
    display:flex;gap:8px;flex-wrap:wrap;align-items:center
  }
  .topbar input[type="text"], .topbar input[type="number"], .topbar select{
    padding:8px 10px;border:1px solid #d0d0d0;border-radius:8px;min-width:120px
  }
  .topbar button{
    padding:8px 12px;border:0;border-radius:20px;cursor:pointer;font-weight:600
  }
  .btn-primary{background:#1976d2;color:#fff}
  .btn-secondary{background:#6c757d;color:#fff}
  .btn-ghost{background:#fff;border:1px solid #d0d0d0}
  .chip{padding:6px 10px;border:1px solid #d0d0d0;border-radius:16px;background:#fff;display:flex;gap:6px;align-items:center}
  .sep{width:1px;height:26px;background:#e6e6e6;margin:0 4px}
  #map{position:fixed;inset:56px 0 0 0}
  .panel{
    position:fixed;left:10px;right:10px;bottom:10px;z-index:9;
    background:rgba(255,255,255,.92);backdrop-filter: blur(8px);
    border-radius:14px;padding:10px 12px;display:flex;gap:12px;flex-wrap:wrap;align-items:center
  }
  .kv{font-size:12px;color:#666}
  .v{font-weight:700;color:#222}
  /* FX overlay */
  #fx-overlay{position:fixed;inset:56px 0 0 0;pointer-events:none}
  #fx-ring{
    position:absolute;inset:0;border:var(--fx-ringW) solid var(--fx-color);border-radius:8px;opacity:0;transform:scale(.98)
  }
  .fx-cross #fx-ring{animation:fxPulse var(--fx-duration) ease-out}
  @keyframes fxPulse{
    0%{opacity:.0;transform:scale(.96)}
    10%{opacity:.9}
    60%{opacity:.35}
    100%{opacity:0;transform:scale(1.04)}
  }
  .shakeL{animation:shakeL 250ms linear}
  .shakeM{animation:shakeM 400ms linear}
  .shakeH{animation:shakeH 600ms linear}
  @keyframes shakeL{ 0%,100%{transform:translate(0,0)} 25%{transform:translate(2px,0)} 50%{transform:translate(-2px,0)} 75%{transform:translate(1px,0)} }
  @keyframes shakeM{ 0%,100%{transform:translate(0,0)} 20%{transform:translate(3px,0)} 40%{transform:translate(-3px,0)} 60%{transform:translate(2px,0)} 80%{transform:translate(-2px,0)} }
  @keyframes shakeH{ 0%,100%{transform:translate(0,0)} 15%{transform:translate(4px,0)} 30%{transform:translate(-4px,0)} 45%{transform:translate(3px,0)} 60%{transform:translate(-3px,0)} 75%{transform:translate(2px,0)} 90%{transform:translate(-2px,0)} }
  .badge{padding:4px 8px;border-radius:12px;font-size:11px;font-weight:700}
  .ok{background:#e8f5e9;color:#2e7d32}
  .warn{background:#fff8e1;color:#b26a00}
  .err{background:#ffebee;color:#c62828}
</style>
</head>
<body>
  <div class="topbar">
    <input id="addr" type="text" placeholder="ì£¼ì†Œ (ì˜ˆ: ì„œìš¸ì‹œì²­)" />
    <input id="radius" type="number" min="10" step="10" value="150" title="ë°˜ê²½(m)" />
    <button class="btn-ghost" id="setZone">ì˜ì—­ ì„¤ì •</button>
    <span class="sep"></span>
    <label class="chip"><input id="optFollow" type="checkbox" checked> ë‚´ ìœ„ì¹˜ ë”°ë¼ê°€ê¸°</label>
    <label class="chip"><input id="optRotate" type="checkbox"> í—¤ë”©ì— ë§ì¶° íšŒì „</label>
    <label class="chip">ê°•ë„
      <select id="intensity">
        <option value="L">L</option>
        <option value="M" selected>M</option>
        <option value="H">H</option>
      </select>
    </label>
    <label class="chip"><input id="optPulse" type="checkbox" checked> í…Œë‘ë¦¬ í„ìŠ¤</label>
    <label class="chip"><input id="optShake" type="checkbox" checked> í”ë“¤ë¦¼</label>
    <label class="chip"><input id="optSound" type="checkbox" checked> ì‚¬ìš´ë“œ</label>
    <label class="chip">ë³¼ë¥¨ <input id="vol" type="range" min="0" max="100" value="70" style="width:120px"></label>
    <button id="enableAudio" class="btn-secondary">ğŸ”Š ì‚¬ìš´ë“œ í™œì„±í™”</button>
    <span class="sep"></span>
    <button class="btn-primary" id="start">ì¶”ì  ì‹œì‘</button>
    <button class="btn-ghost" id="stop" disabled>ì¶”ì  ì¤‘ì§€</button>
  </div>

  <div id="map"></div>
  <div id="fx-overlay"><div id="fx-ring"></div></div>

  <div class="panel">
    <span class="badge" id="status" class="ok">ëŒ€ê¸°</span>
    <span class="kv">ìœ„ë„ <span class="v" id="lat">--</span></span>
    <span class="kv">ê²½ë„ <span class="v" id="lng">--</span></span>
    <span class="kv">ì •í™•ë„ <span class="v" id="acc">-- m</span></span>
    <span class="kv">ì†ë„ <span class="v" id="spd">-- m/s</span></span>
    <span class="kv">ìƒíƒœ <span class="v" id="zoneState">--</span></span>
  </div>

<script src="https://unpkg.com/maplibre-gl@3.6.2/dist/maplibre-gl.js"></script>
<script>
/** ====== ì„¤ì •: MapTiler í‚¤ (ìˆìœ¼ë©´ ì…ë ¥, ì—†ìœ¼ë©´ ê·¸ëŒ€ë¡œ ë‘ì„¸ìš”) ====== */
const MAPTILER_KEY = 'gpg8gRhDhCtaNPgCWYV5'; // <- ì‹¤ì œ í‚¤ ë„£ìœ¼ë©´ ë²¡í„°/3D ìŠ¤íƒ€ì¼ ì‚¬ìš©
const HAS_KEY = MAPTILER_KEY && MAPTILER_KEY !== 'gpg8gRhDhCtaNPgCWYV5';

/** ====== ì§€ë„ ì´ˆê¸°í™” (í‚¤ ì—†ìœ¼ë©´ OSM ë˜ìŠ¤í„° í´ë°±) ====== */
function createMap() {
  const map = new maplibregl.Map({
    container: 'map',
    style: HAS_KEY
      ? `https://api.maptiler.com/maps/streets-v2/style.json?key=${MAPTILER_KEY}`
      : { version: 8, sources: {
            osm: { type:'raster', tiles:['https://a.tile.openstreetmap.org/{z}/{x}/{y}.png'], tileSize:256, attribution:'Â© OpenStreetMap' }
          }, layers:[{ id:'osm', type:'raster', source:'osm' }] },
    center: [126.9780, 37.5665],
    zoom: 13,
    pitch: HAS_KEY ? 60 : 0,
    bearing: -20,
    hash: false
  });
  if (HAS_KEY) map.addControl(new maplibregl.NavigationControl({ visualizePitch: true }), 'top-right');
  else map.addControl(new maplibregl.NavigationControl(), 'top-right');
  return map;
}

/** ====== ì§€ì˜¤ì½”ë”© (MapTiler í‚¤ ìˆì„ ë•Œë§Œ) ====== */
async function geocodeAddress(q){
  if (!HAS_KEY) throw new Error('ì§€ì˜¤ì½”ë”©ì€ MapTiler í‚¤ê°€ í•„ìš”í•©ë‹ˆë‹¤.');
  const url = `https://api.maptiler.com/geocoding/${encodeURIComponent(q)}.json?limit=1&key=${MAPTILER_KEY}`;
  const res = await fetch(url);
  if (!res.ok) throw new Error('Geocoding failed: ' + res.status);
  const j = await res.json();
  if (!j.features?.length) throw new Error('ì£¼ì†Œë¥¼ ì°¾ì§€ ëª»í–ˆìŠµë‹ˆë‹¤.');
  const [lng, lat] = j.features[0].center;
  return {lat, lng, label: j.features[0].place_name || q};
}

/** ====== ê±°ë¦¬/ë„ì›€ í•¨ìˆ˜ ====== */
const R = 6371000;
function haversine(a, b){
  const toRad = d=>d*Math.PI/180;
  const dLat = toRad(b.lat - a.lat);
  const dLng = toRad(b.lng - a.lng);
  const lat1 = toRad(a.lat), lat2 = toRad(b.lat);
  const h = Math.sin(dLat/2)**2 + Math.cos(lat1)*Math.cos(lat2)*Math.sin(dLng/2)**2;
  return 2*R*Math.asin(Math.sqrt(h));
}
const clamp = (v,min,max)=>Math.max(min,Math.min(max,v));

/** ====== í´ë˜ìŠ¤ ====== */
class GPSTracker3D {
  constructor(){
    this.map = createMap();
    this.marker = new maplibregl.Marker({color:'#e53935'});
    this.path = [];
    this.geoFence = null;        // {center:{lat,lng}, radius}
    this.inFence = null;         // null/true/false (ì´ˆê¸° ë¯¸ì •)
    this.watchId = null;
    this.audio = {ctx:null, gain:null};
    this.lastPos = null;
    this.lastTime = 0;

    this.bindUI();
    if (HAS_KEY) {
      this.map.on('load', ()=>{ try { this.add3D(); } catch(e){} });
    }
  }

  add3D(){
    // 3D ê±´ë¬¼ (MapTiler ìŠ¤íƒ€ì¼ì— ì´ë¯¸ í¬í•¨ë˜ì–´ ìˆëŠ” ê²½ìš°ë„ ìˆìŒ. ì¤‘ë³µ ì¶”ê°€ ì‹œ ë¬´ì‹œ)
    // ì—¬ê¸°ì„œëŠ” pitchë§Œ í™œìš©. Terrainì€ ë³„ë„ DEM í‚¤ê°€ ìˆì–´ì•¼ í•˜ë¯€ë¡œ ìƒëµ.
  }

  bindUI(){
    document.getElementById('setZone').onclick = ()=>this.setZoneFromUI();
    document.getElementById('start').onclick   = ()=>this.start();
    document.getElementById('stop').onclick    = ()=>this.stop();
    document.getElementById('enableAudio').onclick = ()=>this.enableAudio();
  }

  async setZoneFromUI(){
    const addr = document.getElementById('addr').value.trim();
    const r = parseFloat(document.getElementById('radius').value)||150;
    try{
      let center;
      if (addr) {
        const g = await geocodeAddress(addr); // í‚¤ ì—†ìœ¼ë©´ ì—ëŸ¬
        center = {lat:g.lat, lng:g.lng};
      } else if (this.lastPos){ // ì£¼ì†Œë¥¼ ë¹„ì›Œë‘ë©´ í˜„ì¬ ìœ„ì¹˜ ê¸°ì¤€
        center = {lat:this.lastPos.lat, lng:this.lastPos.lng};
      } else {
        throw new Error('ì£¼ì†Œë¥¼ ì…ë ¥í•˜ê±°ë‚˜ í˜„ì¬ ìœ„ì¹˜ë¥¼ ë¨¼ì € ì¡ì•„ì£¼ì„¸ìš”.');
      }
      this.setGeofence(center, r);
      this.flashStatus('ì§€ì˜¤íœìŠ¤ ì„¤ì • ì™„ë£Œ', 'ok');
    }catch(e){
      this.flashStatus(e.message, 'warn');
    }
  }

  setGeofence(center, radius){
    this.geoFence = {center, radius};
    // ì‹œê°í™”: ì›ì„ í‘œí˜„í•˜ê¸° ìœ„í•´ GeoJSON circle ë ˆì´ì–´ ìƒì„±
    const idSrc = 'fence-src', idFill='fence-fill', idLine='fence-line';
    if (this.map.getSource(idSrc)) {
      this.map.removeLayer(idFill); this.map.removeLayer(idLine); this.map.removeSource(idSrc);
    }
    const gj = this.circleGeoJSON(center, radius, 128);
    this.map.addSource(idSrc, {type:'geojson', data:gj});
    this.map.addLayer({ id:idFill, type:'fill', source:idSrc,
      paint:{ 'fill-color':'#ff9800','fill-opacity':0.08 }});
    this.map.addLayer({ id:idLine, type:'line', source:idSrc,
      paint:{ 'line-color':'#ff9800','line-width':2,'line-opacity':0.7 }});
    this.map.easeTo({center:[center.lng, center.lat], zoom:15, duration:600, pitch:HAS_KEY?60:0});
  }

  circleGeoJSON(center, radius, steps=64){
    // ë§¤ìš° ê°„ë‹¨í•œ êµ¬ë©´ ê·¼ì‚¬
    const coords=[];
    for (let i=0;i<=steps;i++){
      const theta= (i/steps)*2*Math.PI;
      const dx = (radius/R)*Math.cos(theta);
      const dy = (radius/R)*Math.sin(theta);
      const lat = center.lat + (dy*180/Math.PI);
      const lng = center.lng + (dx*180/Math.PI)/Math.cos(center.lat*Math.PI/180);
      coords.push([lng, lat]);
    }
    return {type:'FeatureCollection',features:[{type:'Feature',geometry:{type:'Polygon',coordinates:[coords]}}]};
  }

  start(){
    if (this.watchId) return;
    if (!navigator.geolocation) { this.flashStatus('ì´ ë¸Œë¼ìš°ì €ëŠ” ìœ„ì¹˜ë¥¼ ì§€ì›í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤','err'); return; }
    const opt={ enableHighAccuracy:true, timeout:10000, maximumAge:0 };
    this.watchId = navigator.geolocation.watchPosition(
      p=>this.onPos(p),
      e=>this.onErr(e),
      opt
    );
    document.getElementById('start').disabled=true;
    document.getElementById('stop').disabled=false;
    this.flashStatus('ìœ„ì¹˜ ì¶”ì  ì‹œì‘','ok');
  }

  stop(){
    if (this.watchId){ navigator.geolocation.clearWatch(this.watchId); this.watchId=null; }
    document.getElementById('start').disabled=false;
    document.getElementById('stop').disabled=true;
    this.flashStatus('ì¶”ì  ì¤‘ì§€','warn');
  }

  onErr(err){
    const m = (err.code===1)?'ìœ„ì¹˜ ê¶Œí•œì´ ê±°ë¶€ë¨':(err.code===2)?'ìœ„ì¹˜ ë¶ˆê°€':(err.code===3)?'ì‹œê°„ì´ˆê³¼':'ì•Œ ìˆ˜ ì—†ëŠ” ì˜¤ë¥˜';
    this.flashStatus(m,'err');
  }

  enableAudio(){
    try{
      if (this.audio.ctx) { this.flashStatus('ì‚¬ìš´ë“œ ì¤€ë¹„ ì™„ë£Œ','ok'); return; }
      const ctx = new (window.AudioContext||window.webkitAudioContext)();
      const gain = ctx.createGain(); gain.connect(ctx.destination);
      gain.gain.value = (document.getElementById('vol').value|0)/100;
      this.audio = {ctx,gain};
      if (ctx.state==='suspended') ctx.resume();
      this.flashStatus('ì‚¬ìš´ë“œ ì¤€ë¹„ ì™„ë£Œ','ok');
    }catch(e){ this.flashStatus('ì˜¤ë””ì˜¤ ì´ˆê¸°í™” ì‹¤íŒ¨','err'); }
  }

  playSound(inside){
    if (!document.getElementById('optSound').checked) return;
    if (!this.audio.ctx) return; // enableAudio í•„ìš”
    const {ctx} = this.audio;
    const v = (document.getElementById('vol').value|0)/100;

    // ì‚¬ìš´ë“œ: ì§„ì…(ë°ê³  ê¸¸ê²Œ), ì´íƒˆ(ì°¨ë¶„í•˜ê³  ì§§ê²Œ)
    const o = ctx.createOscillator();
    const g = ctx.createGain();
    g.gain.value = 0.0001;
    o.connect(g); g.connect(this.audio.gain);

    if (inside){
      // ì§„ì…: ì˜¤ë Œì§€ â€” ë°ê³  ê¸¸ê²Œ
      o.type='triangle';
      o.frequency.setValueAtTime(1046, ctx.currentTime); // C6
      g.gain.exponentialRampToValueAtTime(0.45*v, ctx.currentTime + 0.25);
      g.gain.exponentialRampToValueAtTime(0.0001, ctx.currentTime + 0.9);
      o.start(ctx.currentTime); o.stop(ctx.currentTime + 0.92);
    }else{
      // ì´íƒˆ: ì—°ì²­ â€” ë‚®ê³  ì§§ê²Œ
      o.type='square';
      o.frequency.setValueAtTime(392, ctx.currentTime); // G4
      g.gain.exponentialRampToValueAtTime(0.35*v, ctx.currentTime + 0.15);
      g.gain.exponentialRampToValueAtTime(0.0001, ctx.currentTime + 0.45);
      o.start(ctx.currentTime); o.stop(ctx.currentTime + 0.47);
    }
  }

  playFX(inside){
    const fx = document.getElementById('fx-overlay');
    const ring = document.getElementById('fx-ring');
    const usePulse = document.getElementById('optPulse').checked;
    const useShake = document.getElementById('optShake').checked;
    const level = document.getElementById('intensity').value;
    const color = inside ? '#FF9800' : '#ADD8E6';

    document.documentElement.style.setProperty('--fx-color', color);
    const ringW = level==='L'?'6px':level==='H'?'12px':'9px';
    const duration = level==='L'?800:level==='H'?1400:1100;
    document.documentElement.style.setProperty('--fx-ringW', ringW);
    document.documentElement.style.setProperty('--fx-duration', duration+'ms');

    fx.classList.remove('fx-cross');
    ring.classList.remove('shakeL','shakeM','shakeH');
    void fx.offsetWidth; // reflow

    if (usePulse) fx.classList.add('fx-cross');
    if (useShake) ring.classList.add(level==='L'?'shakeL':level==='H'?'shakeH':'shakeM');

    this.playSound(inside);
    document.getElementById('zoneState').textContent = inside?'ì§„ì…(ì˜¤ë Œì§€)':'ì´íƒˆ(ì—°ì²­ìƒ‰)';
  }

  onPos(p){
    const c = p.coords;
    const now = p.timestamp||Date.now();
    const cur = {lat:c.latitude, lng:c.longitude};
    const spd = (typeof c.speed==='number' && c.speed>=0) ? c.speed : this.estimateSpeed(this.lastPos, this.lastTime, cur, now);
    const hdg = (typeof c.heading==='number' && !Number.isNaN(c.heading)) ? c.heading : null;

    this.lastPos = cur; this.lastTime = now;

    // ë§ˆì»¤ & ê²½ë¡œ
    this.marker.setLngLat([cur.lng,cur.lat]).addTo(this.map);
    this.path.push([cur.lng,cur.lat]);
    this.updatePath();

    // ì •ë³´ UI
    document.getElementById('lat').textContent = cur.lat.toFixed(6);
    document.getElementById('lng').textContent = cur.lng.toFixed(6);
    document.getElementById('acc').textContent = Math.round(c.accuracy||0)+' m';
    document.getElementById('spd').textContent = (spd?spd.toFixed(2):'0')+' m/s';
    this.setStatus('ì¶”ì  ì¤‘','ok');

    // ì¹´ë©”ë¼: ì†ë„ ê¸°ë°˜ ë™ì  ì¤Œ & ë¶€ë“œëŸ¬ìš´ ì´ë™
    const follow = document.getElementById('optFollow').checked;
    const rotate = document.getElementById('optRotate').checked;
    if (follow){
      // ë¹ ë¥¼ìˆ˜ë¡ ì¡°ê¸ˆ ì¤Œ ì•„ì›ƒ (ìì—°ìŠ¤ëŸ¬ìš´ ë‚´ë¹„ ëŠë‚Œ)
      const z = clamp(19 - clamp((spd||0)/5, 0, 2), 16, 19); // 0m/sâ†’19, 10m/sâ†’17
      const brg = rotate && hdg!=null ? hdg : this.map.getBearing();
      this.map.easeTo({
        center:[cur.lng,cur.lat],
        zoom:z,
        pitch: HAS_KEY ? 70 : 0,
        bearing: brg,
        duration: 600,
        easing: t => t*(2-t)   // ë¶€ë“œëŸ¬ìš´ easeInOut
      });
    }

    // ì§€ì˜¤íœìŠ¤ íŒì •
    this.checkFence(cur);
  }

  estimateSpeed(prevPos, prevTime, curPos, curTime){
    if (!prevPos || !prevTime) return 0;
    const dt = (curTime - prevTime)/1000; if (dt<=0) return 0;
    const d = haversine({lat:prevPos.lat,lng:prevPos.lng},{lat:curPos.lat,lng:curPos.lng});
    return d/dt;
  }

  updatePath(){
    const id='path-src', idLine='path-line';
    if (!this.map.getSource(id)){
      this.map.addSource(id, {type:'geojson', data:{type:'FeatureCollection',features:[]}});
      this.map.addLayer({id:idLine,type:'line',source:id,paint:{'line-color':'#FF5722','line-width':3,'line-opacity':0.75}});
    }
    const src=this.map.getSource(id);
    const gj={type:'FeatureCollection',features:[{type:'Feature',geometry:{type:'LineString',coordinates:this.path}}]};
    src.setData(gj);
  }

  checkFence(cur){
    if (!this.geoFence) return;
    const d = haversine({lat:cur.lat,lng:cur.lng}, this.geoFence.center);
    const insideNow = d <= this.geoFence.radius;
    // íˆìŠ¤í…Œë¦¬ì‹œìŠ¤(ê²½ê³„ íŠ•ê¹€ ë°©ì§€): 2.5% ë²„í¼
    const buf = this.geoFence.radius * 0.025;
    if (this.inFence===null){
      this.inFence = insideNow;
      document.getElementById('zoneState').textContent = insideNow?'ì˜ì—­ ë‚´':'ì˜ì—­ ë°–';
      return;
    }
    if (this.inFence && d > this.geoFence.radius + buf){
      this.inFence = false;
      this.playFX(false); // ì´íƒˆ(ì—°ì²­)
    } else if (!this.inFence && d < this.geoFence.radius - buf){
      this.inFence = true;
      this.playFX(true);  // ì§„ì…(ì˜¤ë Œì§€)
    }
  }

  setStatus(text, kind){ // kind: ok|warn|err
    const el = document.getElementById('status');
    el.textContent = text;
    el.className='badge ' + (kind||'ok');
  }
  flashStatus(text, kind){ this.setStatus(text, kind); }
}

const app = new GPSTracker3D();

/** ====== ê°„ë‹¨ í…ŒìŠ¤íŠ¸ (ì½˜ì†”ì—ì„œ ê²°ê³¼ í™•ì¸) ====== */
(function tests(){
  // 1) ê±°ë¦¬ í•¨ìˆ˜
  console.assert(Math.abs(haversine({lat:0,lng:0},{lat:0,lng:1})-111319)<200, 'ê±°ë¦¬ í…ŒìŠ¤íŠ¸(ê²½ë„ 1ë„)');

  // 2) ì§€ì˜¤íœìŠ¤ í¬í•¨/ë°°ì œ
  const center={lat:37,lng:127}, r=200;
  const near={lat:37.001,lng:127};   // ì•½ 111m ë¶ìª½
  const far ={lat:37.003,lng:127};   // ì•½ 333m ë¶ìª½
  console.assert(haversine(center,near) < r, 'ì§€ì˜¤íœìŠ¤ in');
  console.assert(haversine(center,far)  > r, 'ì§€ì˜¤íœìŠ¤ out');

  // 3) ì´ì§• ë‹¨ì¡° ì¦ê°€
  const ease = t=>t*(2-t);
  let prev=-1; for (let i=0;i<=10;i++){ const v=ease(i/10); console.assert(v>=prev,'easing ë‹¨ì¡°ì„±'); prev=v; }
  console.log('%cTests OK','color:green;font-weight:700');
})();
</script>
</body>
</html>
